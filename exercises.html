<!DOCTYPE html>
<html lang="kk">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ARQA | –ñ–∞—Ç—Ç—ã“ì—É–ª–∞—Ä</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"/>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&display=swap" rel="stylesheet">

  <style>
    :root{
      --brand:#02204f;
      --accent:#4a6fa5;
      --header-bg:#a7acd9;
      --radius:12px;
    }
    *{box-sizing:border-box}
    body{font-family:'Inter',sans-serif;background:#f8faff;color:#111827;margin:0}
    header{width:100%;background:var(--header-bg);box-shadow:0 2px 10px rgba(0,0,0,.1);position:relative;z-index:1000}
    .site-nav{max-width:1200px;margin:0 auto;display:flex;align-items:center;justify-content:space-between;padding:10px 20px;height:80px}
    .brand{display:flex;align-items:center}
    .nav-logo-img{max-height:60px;width:auto;display:block}
    .nav-panel{display:flex;gap:20px;align-items:center;margin:0;padding:0;list-style:none}
    .nav-panel>li>a{display:flex;align-items:center;gap:6px;padding:8px 12px;color:var(--brand);font-weight:800;transition:color .2s}
    .nav-panel>li>a:hover{color:#fff}
    .has-sub{position:relative}
    .submenu{position:absolute;left:0;top:100%;width:240px;background:#fff;border-radius:8px;padding:10px 0;box-shadow:0 10px 30px rgba(0,0,0,.15);opacity:0;visibility:hidden;transform:translateY(10px);transition:all .2s;z-index:120}
    .has-sub:hover .submenu{opacity:1;visibility:visible;transform:translateY(0)}
    .submenu li{list-style:none}
    .submenu a{display:block;padding:10px 20px;color:var(--brand);font-weight:600;font-size:.95rem}
    .submenu a:hover{background:#f0f4f8;color:var(--accent)}
    .has-sub-right{position:relative}
    .submenu-right{position:absolute;left:100%;top:0;width:200px;background:#fff;border-radius:8px;padding:10px 0;box-shadow:0 10px 30px rgba(0,0,0,.15);opacity:0;visibility:hidden;transition:all .2s;z-index:140}
    .has-sub-right:hover .submenu-right{opacity:1;visibility:visible}
    .fade-in{animation:fadeIn .35s ease-in-out}
    @keyframes fadeIn{from{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}
    .level-card{transition:all .25s ease;cursor:pointer;overflow:hidden;position:relative}
    .level-card:hover{transform:translateY(-5px);box-shadow:0 20px 25px -5px rgba(0,0,0,.12)}
    .view-section{display:none}
    .view-section.active{display:block}
    .custom-scrollbar::-webkit-scrollbar{width:6px}
    .custom-scrollbar::-webkit-scrollbar-track{background:#f1f1f1}
    .custom-scrollbar::-webkit-scrollbar-thumb{background:#cbd5e1;border-radius:10px}
    .custom-scrollbar::-webkit-scrollbar-thumb:hover{background:#94a3b8}
    @media(max-width:768px){
      .site-nav{flex-direction:column;height:auto;padding:15px}
      .nav-panel{flex-direction:column;width:100%;gap:10px;margin-top:15px}
      .submenu,.submenu-right{position:static;box-shadow:none;padding-left:20px;display:none}
      .has-sub:hover .submenu{display:block;opacity:1;visibility:visible;transform:none}
    }
  </style>
</head>

<body class="min-h-screen flex flex-col">
  <header>
    <nav class="site-nav" role="navigation" aria-label="–ë–∞—Å—Ç—ã –Ω–∞–≤–∏–≥–∞—Ü–∏—è">
      <div class="brand">
        <a href="index.html" class="logo-link">
          <img src="arqa.png" alt="ARQA Logo" class="nav-logo-img" />
        </a>
      </div>

      <ul class="nav-panel">
        <li class="has-sub">
          <a href="info.html">–°–∫–æ–ª–∏–æ–∑ —Ç—É—Ä–∞–ª—ã <i class="fa-solid fa-chevron-down" style="font-size:.7em;"></i></a>
          <ul class="submenu">
            <li><a href="info.html">–°–∫–æ–ª–∏–æ–∑ –¥–µ–≥–µ–Ω—ñ–º—ñ–∑ –Ω–µ?</a></li>
            <li class="has-sub-right">
              <a href="idiopathic.html" style="display:flex;justify-content:space-between;">
                –°–∫–æ–ª–∏–æ–∑ —Ç“Ø—Ä–ª–µ—Ä—ñ <i class="fa-solid fa-chevron-right" style="font-size:.7em;"></i>
              </a>
              <ul class="submenu-right">
                <li><a href="idiopathic.html">–ò–¥–∏–æ–ø–∞—Ç–∏—è–ª—ã“õ</a></li>
                <li><a href="congenital.html">–¢—É–∞ –±—ñ—Ç–∫–µ–Ω</a></li>
                <li><a href="degenerative.html">–î–µ–≥–µ–Ω–µ—Ä–∞—Ç–∏–≤—Ç—ñ</a></li>
                <li><a href="lumbar.html">–ë–µ–ª –æ–º—ã—Ä—Ç“õ–∞–ª—ã</a></li>
                <li><a href="neuromuscular.html">–ù–µ–π—Ä–æ–±“±–ª—à—ã“õ–µ—Ç</a></li>
                <li><a href="syndromic.html">–°–∏–Ω–¥—Ä–æ–º–¥—ã“õ</a></li>
              </ul>
            </li>
            <li><a href="consequences.html">–°–∞–ª–¥–∞—Ä—ã</a></li>
            <li><a href="treatment.html">–ï–º–¥–µ—É –∂–æ–ª–¥–∞—Ä—ã</a></li>
          </ul>
        </li>
        <li><a href="test.html">–¢–µ–∫—Å–µ—Ä—É</a></li>
        <li><a href="exercises.html">–ñ–∞—Ç—Ç—ã“ì—É–ª–∞—Ä</a></li>
        <li><a href="prevention.html">–ê–ª–¥—ã–Ω –∞–ª—É</a></li>
        <li><a href="Helplines.html">–ö–ª–∏–Ω–∏–∫–∞–ª–∞—Ä</a></li>
        <li><a href="About.html">–ë—ñ–∑ –∂–∞–π–ª—ã</a></li>
      </ul>
    </nav>
  </header>

  <div class="flex items-center justify-end px-4 py-2 bg-white border-b" id="user-header">
    <span id="user-display" class="text-sm text-gray-600 mr-2">–ö—ñ—Ä—É –∫–µ—Ä–µ–∫</span>
    <button id="profile-btn" onclick="toggleProfile()" class="text-gray-500 hover:text-[#4a6fa5] transition mr-3 hidden">
      <i class="fa-solid fa-user-circle fa-lg"></i>
    </button>
    <button onclick="toggleAuth()" class="text-gray-500 hover:text-[#4a6fa5] transition">
      <i class="fa-solid fa-user fa-lg"></i>
    </button>
  </div>

  <div id="profile-modal" class="hidden fixed inset-0 bg-black/50 flex items-center justify-center z-50">
    <div class="bg-white rounded-2xl p-8 max-w-2xl w-full shadow-2xl max-h-[80vh] overflow-y-auto">
      <div class="flex justify-between items-center mb-6">
        <h2 class="text-2xl font-extrabold text-gray-900">–ñ–µ–∫–µ –∫–∞–±–∏–Ω–µ—Ç</h2>
        <button onclick="toggleProfile()" class="text-gray-400 hover:text-gray-600">
          <i class="fa-solid fa-times fa-lg"></i>
        </button>
      </div>

      <div class="mb-6 pb-6 border-b">
        <h3 class="text-lg font-extrabold text-gray-800 mb-3">–ü—Ä–æ—Ñ–∏–ª—å</h3>
        <div class="grid grid-cols-2 gap-4 text-sm">
          <div>
            <span class="text-gray-500">–ê—Ç—ã-–∂”©–Ω—ñ:</span>
            <p id="profile-fullname" class="font-semibold text-gray-900">‚Äî</p>
          </div>
          <div>
            <span class="text-gray-500">Email:</span>
            <p id="profile-email" class="font-semibold text-gray-900">‚Äî</p>
          </div>
          <div>
            <span class="text-gray-500">–¢—ñ—Ä–∫–µ–ª–≥–µ–Ω –∫“Ø–Ω—ñ:</span>
            <p id="profile-created" class="font-semibold text-gray-900">‚Äî</p>
          </div>
          <div>
            <span class="text-gray-500">–î–µ“£–≥–µ–π:</span>
            <p id="profile-level" class="font-semibold text-gray-900">‚Äî</p>
          </div>
        </div>
      </div>

      <div class="mb-6 pb-6 border-b">
        <h3 class="text-lg font-extrabold text-gray-800 mb-4">30 –∫“Ø–Ω–¥—ñ–∫ –ø—Ä–æ–≥—Ä–µ—Å—Å</h3>
        <div class="space-y-3">
          <div>
            <div class="flex justify-between items-center mb-2">
              <span class="text-sm font-medium text-gray-600">–ê—è“õ—Ç–∞–ª“ì–∞–Ω –∫“Ø–Ω–¥–µ—Ä</span>
              <span id="progress-days" class="text-sm font-extrabold text-[#4a6fa5]">0/30</span>
            </div>
            <div class="w-full bg-gray-200 rounded-full h-3">
              <div id="progress-bar" class="bg-gradient-to-r from-[#4a6fa5] to-[#2c4a75] h-3 rounded-full" style="width:0%"></div>
            </div>
          </div>
        </div>
      </div>

      <div class="mb-6 pb-6 border-b">
        <h3 class="text-lg font-extrabold text-gray-800 mb-4">–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h3>
        <div class="grid grid-cols-4 gap-3 text-center">
          <div class="bg-blue-50 p-3 rounded-lg">
            <p id="stat-workouts" class="text-2xl font-extrabold text-[#4a6fa5]">0</p>
            <p class="text-xs text-gray-600">–ö“Ø–Ω</p>
          </div>
          <div class="bg-green-50 p-3 rounded-lg">
            <p id="stat-minutes" class="text-2xl font-extrabold text-green-600">0</p>
            <p class="text-xs text-gray-600">–ú–∏–Ω—É—Ç</p>
          </div>
          <div class="bg-orange-50 p-3 rounded-lg">
            <p id="stat-streak" class="text-2xl font-extrabold text-orange-600">0</p>
            <p class="text-xs text-gray-600">“ö–∞—Ç–∞—Ä</p>
          </div>
          <div class="bg-purple-50 p-3 rounded-lg">
            <p id="stat-xp" class="text-2xl font-extrabold text-purple-700">0</p>
            <p class="text-xs text-gray-600">“∞–ø–∞–π</p>
          </div>
        </div>
      </div>

      <div class="mb-6 pb-6 border-b">
        <h3 class="text-lg font-extrabold text-gray-800 mb-3">–ñ–µ—Ç—ñ—Å—Ç—ñ–∫—Ç–µ—Ä</h3>
        <div id="badges" class="grid grid-cols-2 md:grid-cols-3 gap-3"></div>
      </div>

      <div class="mb-6">
        <h3 class="text-lg font-extrabold text-gray-800 mb-3">–°–æ“£“ì—ã –±–µ–ª—Å–µ–Ω–¥—ñ–ª—ñ–∫</h3>
        <div id="activity-list" class="space-y-2 text-sm text-gray-600">
          <p class="text-gray-400">–ë–µ–ª—Å–µ–Ω–¥—ñ–ª—ñ–∫ –∂–æ“õ</p>
        </div>
      </div>

      <div class="flex gap-3">
        <button onclick="logoutUser()" class="flex-1 bg-red-600 text-white font-extrabold py-2 rounded-lg hover:bg-red-700 transition">–®—ã“ì—É</button>
        <button onclick="toggleProfile()" class="flex-1 bg-gray-200 text-gray-800 font-extrabold py-2 rounded-lg hover:bg-gray-300 transition">–ñ–∞–±—É</button>
      </div>
    </div>
  </div>

  <div id="badge-modal" class="hidden fixed inset-0 bg-black/50 flex items-center justify-center z-50">
    <div class="bg-white rounded-2xl p-8 max-w-md w-full shadow-2xl text-center">
      <div class="w-20 h-20 bg-yellow-100 rounded-full flex items-center justify-center mx-auto mb-4">
        <i class="fa-solid fa-medal text-4xl text-yellow-600"></i>
      </div>
      <h3 class="text-2xl font-extrabold text-gray-900 mb-2">–ñ–∞“£–∞ –∂–µ—Ç—ñ—Å—Ç—ñ–∫!</h3>
      <p id="badge-text" class="text-gray-600 mb-6">‚Äî</p>
      <button onclick="closeBadgeModal()" class="w-full bg-gray-900 text-white font-extrabold py-3 rounded-xl hover:bg-gray-800 transition">–ñ–∞–±—É</button>
    </div>
  </div>

  <main class="flex-grow container mx-auto px-4 py-8 max-w-6xl">
    <div id="auth-modal" class="hidden fixed inset-0 bg-black/50 flex items-center justify-center z-50">
      <div class="bg-white rounded-2xl p-8 max-w-md w-full shadow-2xl">
        <div id="auth-signup" class="auth-tab">
          <h2 class="text-2xl font-extrabold mb-6 text-gray-900">–¢—ñ—Ä–∫–µ–ª—É</h2>
          <div class="mb-4">
            <label class="block text-sm font-semibold text-gray-700 mb-2">–ê—Ç—ã-–∂”©–Ω—ñ</label>
            <input type="text" id="signup-fullname" placeholder="–¢–æ–ª—ã“õ –∞—Ç—ã-–∂”©–Ω—ñ“£—ñ–∑" class="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#4a6fa5]">
          </div>
          <div class="mb-4">
            <label class="block text-sm font-semibold text-gray-700 mb-2">Email</label>
            <input type="email" id="signup-email" placeholder="email@example.com" class="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#4a6fa5]">
          </div>
          <div class="mb-4">
            <label class="block text-sm font-semibold text-gray-700 mb-2">–ü–∞—Ä–æ–ª—å</label>
            <input type="password" id="signup-password" placeholder="–ö–µ–º—ñ–Ω–¥–µ 6 —Ç–∞“£–±–∞" class="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#4a6fa5]">
          </div>
          <div class="mb-6">
            <label class="block text-sm font-semibold text-gray-700 mb-2">–ü–∞—Ä–æ–ª—å–¥—ñ —Ä–∞—Å—Ç–∞—É</label>
            <input type="password" id="signup-confirm" placeholder="–ü–∞—Ä–æ–ª—å–¥—ñ “õ–∞–π—Ç–∞ —Ç–µ—Ä—ñ“£—ñ–∑" class="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#4a6fa5]">
          </div>
          <button onclick="signupUser()" class="w-full bg-[#4a6fa5] text-white font-extrabold py-3 rounded-lg hover:bg-[#3d5a8a] transition mb-3">–¢—ñ—Ä–∫–µ–ª—É</button>
          <p class="text-center text-sm text-gray-600">–ï—Å–µ–ø –±–∞—Ä –º–∞? <button onclick="toggleAuthTab()" class="text-[#4a6fa5] font-extrabold hover:underline">–ö—ñ—Ä—É</button></p>
        </div>

        <div id="auth-login" class="auth-tab hidden">
          <h2 class="text-2xl font-extrabold mb-6 text-gray-900">–ö—ñ—Ä—É</h2>
          <div class="mb-4">
            <label class="block text-sm font-semibold text-gray-700 mb-2">Email</label>
            <input type="email" id="login-email" placeholder="email@example.com" class="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#4a6fa5]">
          </div>
          <div class="mb-6">
            <label class="block text-sm font-semibold text-gray-700 mb-2">–ü–∞—Ä–æ–ª—å</label>
            <input type="password" id="login-password" placeholder="–ü–∞—Ä–æ–ª—å" class="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#4a6fa5]">
          </div>
          <button onclick="loginUser()" class="w-full bg-[#4a6fa5] text-white font-extrabold py-3 rounded-lg hover:bg-[#3d5a8a] transition mb-3">–ö—ñ—Ä—É</button>
          <p class="text-center text-sm text-gray-600">–ï—Å–µ–ø –∂–æ“õ –ø–∞? <button onclick="toggleAuthTab()" class="text-[#4a6fa5] font-extrabold hover:underline">–¢—ñ—Ä–∫–µ–ª—É</button></p>
        </div>

        <button onclick="toggleAuth()" class="w-full bg-gray-200 text-gray-800 font-extrabold py-3 rounded-lg hover:bg-gray-300 transition mt-3">–ñ–∞–±—É</button>
      </div>
    </div>

    <div id="view-levels" class="view-section active fade-in">
      <div class="text-center mb-10">
        <h1 class="text-3xl md:text-5xl font-extrabold text-gray-900 mb-4">30 –∫“Ø–Ω–¥—ñ–∫ –∂–∞—Ç—Ç—ã“ì—É –±–∞“ì–¥–∞—Ä–ª–∞–º–∞—Å—ã</h1>
      </div>

      <div class="grid md:grid-cols-3 gap-8 max-w-5xl mx-auto">
        <div onclick="selectLevel('beginner')" class="level-card bg-gradient-to-br from-green-400 to-emerald-600 rounded-2xl h-96 relative flex shadow-xl group text-white">
          <div class="absolute inset-0 bg-black/10 group-hover:bg-black/0 transition"></div>
          <div class="relative z-10 p-8 flex flex-col justify-between w-full h-full">
            <div>
              <span class="bg-white/20 backdrop-blur-md px-3 py-1 rounded-full text-xs font-extrabold uppercase tracking-wider">5‚Äì10 –º–∏–Ω—É—Ç</span>
              <h3 class="text-3xl font-extrabold mt-4">–ë–∞—Å—Ç–∞—É—à—ã</h3>
              <p class="text-green-100 text-sm mt-2 opacity-90">–ñ“±–º—Å–∞“õ –º–æ–±–∏–ª–∏—Ç–∏, –¥“±—Ä—ã—Å “õ–∞–ª—ã–ø –∂”ô–Ω–µ –±–∞–∑–∞–ª—ã“õ –∫“Ø—à.</p>
            </div>
            <div class="flex justify-between items-end">
              <i class="fa-solid fa-seedling text-6xl opacity-50 group-hover:scale-110 transition duration-500"></i>
              <span class="font-extrabold tracking-widest text-lg opacity-90">BEGINNER</span>
            </div>
          </div>
        </div>

        <div onclick="selectLevel('intermediate')" class="level-card bg-gradient-to-br from-blue-400 to-indigo-600 rounded-2xl h-96 relative flex shadow-xl group text-white">
          <div class="absolute inset-0 bg-black/10 group-hover:bg-black/0 transition"></div>
          <div class="relative z-10 p-8 flex flex-col justify-between w-full h-full">
            <div>
              <span class="bg-white/20 backdrop-blur-md px-3 py-1 rounded-full text-xs font-extrabold uppercase tracking-wider">9‚Äì15 –º–∏–Ω—É—Ç</span>
              <h3 class="text-3xl font-extrabold mt-4">–û—Ä—Ç–∞—à–∞</h3>
              <p class="text-blue-100 text-sm mt-2 opacity-90">–¢“±—Ä–∞“õ—Ç–∞–Ω–¥—ã—Ä—É, ”©–∑–µ–∫ (core), –∂–∞—É—ã—Ä—ã–Ω –±–∞“õ—ã–ª–∞—É—ã.</p>
            </div>
            <div class="flex justify-between items-end">
              <i class="fa-solid fa-person-running text-6xl opacity-50 group-hover:scale-110 transition duration-500"></i>
              <span class="font-extrabold tracking-widest text-lg opacity-90">INTERMEDIATE</span>
            </div>
          </div>
        </div>

        <div onclick="selectLevel('advanced')" class="level-card bg-gradient-to-br from-orange-400 to-red-600 rounded-2xl h-96 relative flex shadow-xl group text-white">
          <div class="absolute inset-0 bg-black/10 group-hover:bg-black/0 transition"></div>
          <div class="relative z-10 p-8 flex flex-col justify-between w-full h-full">
            <div>
              <span class="bg-white/20 backdrop-blur-md px-3 py-1 rounded-full text-xs font-extrabold uppercase tracking-wider">12‚Äì18 –º–∏–Ω—É—Ç</span>
              <h3 class="text-3xl font-extrabold mt-4">–ö“Ø—Ä–¥–µ–ª—ñ</h3>
              <p class="text-orange-100 text-sm mt-2 opacity-90">“∞–∑–∞“õ “±—Å—Ç–∞–ø —Ç“±—Ä—É, –∞—Å–∏–º–º–µ—Ç—Ä–∏—è–Ω—ã –±–∞“õ—ã–ª–∞—É, —Ç”©–∑—ñ–º–¥—ñ–ª—ñ–∫.</p>
            </div>
            <div class="flex justify-between items-end">
              <i class="fa-solid fa-dumbbell text-6xl opacity-50 group-hover:scale-110 transition duration-500"></i>
              <span class="font-extrabold tracking-widest text-lg opacity-90">ADVANCED</span>
            </div>
          </div>
        </div>
      </div>

      <div class="max-w-5xl mx-auto mt-10 bg-white rounded-2xl p-6 shadow-sm border border-gray-100">
        <div class="grid md:grid-cols-3 gap-6">
          <div class="flex gap-3">
            <div class="w-10 h-10 rounded-xl bg-blue-50 flex items-center justify-center text-[#4a6fa5]">
              <i class="fa-solid fa-shield-heart"></i>
            </div>
            <div>
              <p class="font-extrabold text-gray-900">“ö–∞—É—ñ–ø—Å—ñ–∑ “õ–∞“ì–∏–¥–∞</p>
              <p class="text-sm text-gray-600">–ê—É—ã—Ä—Å—ã–Ω—É –±–æ–ª—Å–∞ —Ç–æ“õ—Ç–∞“£—ã–∑. “ö–∞—Ç—Ç—ã ‚Äú–±“±—Ä—ã–ª—ã—Å—Ç–∞—Ä—Å—ã–∑‚Äù, “õ–æ–∑“ì–∞–ª—ã—Å –±–∞“õ—ã–ª–∞—É–º–µ–Ω.</p>
            </div>
          </div>
          <div class="flex gap-3">
            <div class="w-10 h-10 rounded-xl bg-green-50 flex items-center justify-center text-green-700">
              <i class="fa-solid fa-chart-line"></i>
            </div>
            <div>
              <p class="font-extrabold text-gray-900">–ü—Ä–æ–≥—Ä–µ—Å—Å —Å–∞“õ—Ç–∞–ª–∞–¥—ã</p>
              <p class="text-sm text-gray-600">–ö“Ø–Ω –∞—è“õ—Ç–∞–ª“ì–∞–Ω —Å–æ“£, –µ—Å–µ–ø—Ç–µ –±–µ–ª–≥—ñ–ª–µ–Ω–µ–¥—ñ –∂”ô–Ω–µ “±–ø–∞–π “õ–æ—Å—ã–ª–∞–¥—ã.</p>
            </div>
          </div>
          <div class="flex gap-3">
            <div class="w-10 h-10 rounded-xl bg-yellow-50 flex items-center justify-center text-yellow-700">
              <i class="fa-solid fa-trophy"></i>
            </div>
            <div>
              <p class="font-extrabold text-gray-900">–ñ–µ—Ç—ñ—Å—Ç—ñ–∫ –∂“Ø–π–µ—Å—ñ</p>
              <p class="text-sm text-gray-600">1 –∫“Ø–Ω, 7 –∫“Ø–Ω “õ–∞—Ç–∞—Ä, 15 –∫“Ø–Ω, 30 –∫“Ø–Ω –∂”ô–Ω–µ ‚Äú“õ–∞—Ç–µ—Å—ñ–∑ –æ—Ä—ã–Ω–¥–∞—É‚Äù –±–µ–ª–≥—ñ–ª–µ—Ä—ñ.</p>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div id="view-plan" class="view-section fade-in">
      <div class="flex items-center mb-8">
        <button onclick="showView('view-levels')" class="w-10 h-10 rounded-full bg-white shadow-md flex items-center justify-center text-gray-600 hover:text-[#4a6fa5] mr-4 transition">
          <i class="fa-solid fa-arrow-left"></i>
        </button>
        <div>
          <h2 id="plan-title" class="text-3xl font-extrabold text-gray-900">–ñ–æ—Å–ø–∞—Ä</h2>
          <p class="text-gray-500 text-sm">30 –∫“Ø–Ω–¥—ñ–∫ –±–∞“ì–¥–∞—Ä–ª–∞–º–∞</p>
        </div>
      </div>
      <div class="grid grid-cols-2 sm:grid-cols-4 md:grid-cols-5 lg:grid-cols-6 gap-4" id="days-grid"></div>
    </div>

    <div id="view-overview" class="view-section fade-in">
      <div class="max-w-4xl mx-auto">
        <div class="bg-white rounded-3xl shadow-xl overflow-hidden">
          <div class="h-52 bg-gradient-to-r from-[#4a6fa5] to-[#2c4a75] relative p-8 flex flex-col justify-end">
            <button onclick="showView('view-plan')" class="absolute top-6 left-6 bg-white/20 hover:bg-white/30 text-white p-2 rounded-full backdrop-blur-sm transition">
              <i class="fa-solid fa-arrow-left fa-lg"></i>
            </button>
            <h2 id="overview-day-title" class="text-4xl font-extrabold text-white">1-–∫“Ø–Ω</h2>
            <div class="flex flex-wrap items-center gap-4 mt-2 text-white/90">
              <span class="flex items-center gap-2"><i class="fa-regular fa-clock"></i> <span id="overview-time">‚Äî</span></span>
              <span class="flex items-center gap-2"><i class="fa-solid fa-layer-group"></i> <span id="overview-count">‚Äî</span></span>
              <span class="flex items-center gap-2"><i class="fa-solid fa-mug-hot"></i> <span id="overview-rest">‚Äî</span></span>
            </div>
          </div>

          <div class="p-6 md:p-8">
            <div class="flex justify-between items-center mb-6">
              <h3 class="text-xl font-extrabold text-gray-800">–ë“Ø–≥—ñ–Ω–≥—ñ —Ç—ñ–∑—ñ–º</h3>
              <span id="overview-rule" class="text-xs font-extrabold text-gray-500 bg-gray-100 px-3 py-1 rounded-full">‚Äî</span>
            </div>

            <div id="exercise-list" class="space-y-3 custom-scrollbar max-h-[520px] overflow-y-auto pr-2"></div>

            <button onclick="startWorkout()" class="w-full mt-8 bg-[#4a6fa5] hover:bg-[#3d5a8a] text-white font-extrabold text-lg py-4 rounded-xl shadow-lg transform hover:scale-[1.02] transition flex items-center justify-center gap-3">
              <i class="fa-solid fa-play"></i> –ë–ê–°–¢–ê–£
            </button>
          </div>
        </div>
      </div>
    </div>

    <div id="view-workout" class="view-section fade-in max-w-3xl mx-auto pt-4 pb-24">
      <div class="flex justify-between items-center mb-6">
        <button onclick="quitWorkout()" class="text-gray-400 hover:text-red-500 transition">
          <i class="fa-solid fa-xmark fa-2x"></i>
        </button>
        <div class="flex flex-col items-center">
          <span class="text-xs text-gray-400 uppercase font-extrabold tracking-wider">–ü—Ä–æ–≥—Ä–µ—Å—Å</span>
          <span id="workout-step" class="text-lg font-extrabold text-[#4a6fa5]">1 / 10</span>
        </div>
        <button onclick="toggleTips()" class="text-gray-400 hover:text-yellow-500 transition">
          <i class="fa-regular fa-lightbulb fa-2x"></i>
        </button>
      </div>

      <div class="flex-1 flex flex-col items-center justify-center relative min-h-[620px]">
        <div id="tips-overlay" class="hidden absolute top-0 left-0 w-full h-full bg-white/95 backdrop-blur-sm z-20 rounded-3xl p-8 flex flex-col justify-center items-center text-center shadow-lg border border-yellow-100">
          <div class="bg-yellow-100 p-4 rounded-full mb-4 text-yellow-700">
            <i class="fa-solid fa-lightbulb fa-3x"></i>
          </div>
          <h3 class="text-2xl font-extrabold text-gray-800 mb-4">–ù“±—Å“õ–∞—É–ª—ã“õ</h3>
          <p id="tip-text" class="text-lg text-gray-600 leading-relaxed mb-8 max-w-sm">‚Äî</p>
          <button onclick="toggleTips()" class="px-8 py-2 bg-gray-900 text-white rounded-lg hover:bg-gray-800 font-extrabold">–ñ–∞–±—É</button>
        </div>

        <div class="mb-6 w-full">
          <div class="bg-white rounded-2xl shadow-sm border border-gray-100 p-4 flex gap-4 items-center">
            <div id="workout-image" class="w-20 h-20 rounded-xl bg-gray-50 flex items-center justify-center overflow-hidden"></div>
            <div class="flex-1">
              <h2 id="workout-name" class="text-2xl md:text-3xl font-extrabold text-gray-900 leading-tight">‚Äî</h2>
              <p id="workout-sub" class="text-gray-500 font-semibold text-sm mt-1">‚Äî</p>
            </div>
          </div>
        </div>

        <a id="youtube-link" href="#" target="_blank" class="mb-6 bg-red-600 text-white px-6 py-3 rounded-full font-extrabold flex items-center gap-2 hover:bg-red-700 transition shadow-lg">
          <i class="fa-brands fa-youtube fa-lg"></i> YouTube –±–µ–π–Ω–µ
        </a>

        <div class="relative w-64 h-64 mb-6">
          <svg class="w-full h-full transform -rotate-90">
            <circle class="text-gray-200 stroke-current" stroke-width="12" cx="128" cy="128" r="120" fill="transparent"></circle>
            <circle id="timer-circle" class="text-[#4a6fa5] transition-all duration-1000 stroke-current" stroke-width="12" stroke-linecap="round" cx="128" cy="128" r="120" fill="transparent" stroke-dasharray="753.98" stroke-dashoffset="0"></circle>
          </svg>
          <div class="absolute inset-0 flex items-center justify-center flex-col">
            <span id="timer-display" class="text-6xl font-extrabold text-gray-800 tabular-nums">00:30</span>
            <span id="timer-label" class="text-sm text-gray-500 font-semibold mt-2">‚Äî</span>
          </div>
        </div>

        <div class="w-full bg-white rounded-2xl shadow-sm border border-gray-100 p-5">
          <h3 class="font-extrabold text-gray-900 mb-2">“ö–∞–ª–∞–π –æ—Ä—ã–Ω–¥–∞—É –∫–µ—Ä–µ–∫</h3>
          <ol id="howto" class="list-decimal pl-5 space-y-1 text-gray-700 text-sm"></ol>
        </div>
      </div>

      <div class="grid grid-cols-3 gap-6 fixed bottom-8 left-1/2 transform -translate-x-1/2 w-full max-w-2xl px-4">
        <button onclick="prevExercise()" class="bg-white border border-gray-200 hover:bg-gray-50 text-gray-700 rounded-2xl py-4 shadow-sm flex items-center justify-center">
          <i class="fa-solid fa-backward-step fa-xl"></i>
        </button>
        <button id="btn-play-pause" onclick="toggleTimer()" class="bg-[#4a6fa5] hover:bg-[#3d5a8a] text-white rounded-2xl py-4 shadow-lg shadow-blue-200 flex items-center justify-center transform active:scale-95 transition">
          <i class="fa-solid fa-pause fa-2x"></i>
        </button>
        <button onclick="nextExercise()" class="bg-white border border-gray-200 hover:bg-gray-50 text-gray-700 rounded-2xl py-4 shadow-sm flex items-center justify-center">
          <i class="fa-solid fa-forward-step fa-xl"></i>
        </button>
      </div>
    </div>

    <div id="view-result" class="view-section fade-in text-center py-12">
      <div class="max-w-md mx-auto bg-white p-8 rounded-3xl shadow-xl">
        <div class="w-24 h-24 bg-yellow-100 rounded-full flex items-center justify-center mx-auto mb-6">
          <i class="fa-solid fa-trophy text-5xl text-yellow-600"></i>
        </div>

        <h2 class="text-3xl font-extrabold text-gray-900 mb-2">–ñ–∞—Ä–∞–π—Å—ã“£!</h2>
        <p class="text-gray-500 mb-6">–ë“Ø–≥—ñ–Ω–≥—ñ –∫“Ø–Ω –∞—è“õ—Ç–∞–ª–¥—ã. –ü—Ä–æ–≥—Ä–µ—Å—Å —Å–∞“õ—Ç–∞–ª–¥—ã.</p>

        <div class="grid grid-cols-2 gap-4 mb-6">
          <div class="bg-gradient-to-br from-blue-100 to-blue-50 p-6 rounded-2xl">
            <span class="block text-3xl font-extrabold text-[#4a6fa5]" id="result-time">‚Äî</span>
            <span class="text-xs text-gray-600 uppercase font-extrabold">–£–∞“õ—ã—Ç</span>
          </div>
          <div class="bg-gradient-to-br from-green-100 to-green-50 p-6 rounded-2xl">
            <span class="block text-3xl font-extrabold text-green-700" id="result-count">‚Äî</span>
            <span class="text-xs text-gray-600 uppercase font-extrabold">–ñ–∞—Ç—Ç—ã“ì—É</span>
          </div>
        </div>

        <h3 class="font-extrabold text-gray-800 mb-3">“ö–∞–ª–∞–π —Å–µ–∑—ñ–Ω–µ—Å—ñ“£?</h3>
        <div class="flex justify-center gap-4 mb-6">
          <button onclick="saveMood(1)" class="text-3xl hover:scale-110 transition">üò´</button>
          <button onclick="saveMood(2)" class="text-3xl hover:scale-110 transition">üòê</button>
          <button onclick="saveMood(3)" class="text-3xl hover:scale-110 transition">üôÇ</button>
          <button onclick="saveMood(4)" class="text-3xl hover:scale-110 transition">üòÉ</button>
          <button onclick="saveMood(5)" class="text-3xl hover:scale-110 transition">ü§©</button>
        </div>

        <button onclick="finishWorkout()" class="w-full bg-gray-900 text-white font-extrabold py-4 rounded-xl shadow-lg hover:bg-gray-800 transition">
          –ë–∞—Å—Ç—ã –±–µ—Ç–∫–µ –æ—Ä–∞–ª—É
        </button>
      </div>
    </div>
  </main>

  <script>
    const ICONS = {
      posture: svgData(`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 96 96"><rect width="96" height="96" rx="18" fill="#eef6ff"/><path d="M52 18c6 0 10 4 10 10s-4 10-10 10-10-4-10-10 4-10 10-10Zm-8 26c2-4 6-6 10-6s8 2 10 6l6 13c1 2 0 5-3 6-2 1-5 0-6-3l-3-7v29c0 3-2 5-5 5s-5-2-5-5V63h-2v19c0 3-2 5-5 5s-5-2-5-5V53l-3 7c-1 3-4 4-6 3-3-1-4-4-3-6l6-13Z" fill="#2c4a75"/></svg>`),
      stretch: svgData(`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 96 96"><rect width="96" height="96" rx="18" fill="#eefcf3"/><path d="M60 20c5 0 9 4 9 9s-4 9-9 9-9-4-9-9 4-9 9-9Zm-35 51c0-4 3-7 7-7h21l10-12c2-2 5-2 7 0s2 5 0 7L58 73c-1 2-3 3-5 3H32c-4 0-7-3-7-5Zm23-9h-9c2-8 7-16 15-21l5 7c-6 4-9 9-11 14Z" fill="#1f7a4d"/></svg>`),
      core: svgData(`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 96 96"><rect width="96" height="96" rx="18" fill="#f3f0ff"/><path d="M48 16c6 0 11 5 11 11s-5 11-11 11-11-5-11-11 5-11 11-11Zm-18 64c0-12 8-22 18-22s18 10 18 22c0 4-3 7-7 7H37c-4 0-7-3-7-7Zm12-10h12v-6H42v6Z" fill="#5b46b0"/></svg>`),
      back: svgData(`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 96 96"><rect width="96" height="96" rx="18" fill="#fff3e8"/><path d="M48 14c7 0 12 5 12 12S55 38 48 38s-12-5-12-12 5-12 12-12Zm-6 28h12c10 0 18 8 18 18v18c0 4-3 7-7 7-3 0-6-2-7-5l-4-12h-2l-4 12c-1 3-4 5-7 5-4 0-7-3-7-7V60c0-10 8-18 18-18Z" fill="#9a3b10"/></svg>`),
      balance: svgData(`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 96 96"><rect width="96" height="96" rx="18" fill="#f0fff6"/><path d="M50 16c6 0 10 4 10 10s-4 10-10 10-10-4-10-10 4-10 10-10Zm-8 24h16c6 0 12 4 14 10l4 10c1 3 0 6-3 7-3 1-6 0-7-3l-2-6v24c0 3-2 6-6 6-3 0-6-3-6-6V66l-4 4c-2 2-5 2-7 0-2-2-2-5 0-7l8-8v-8l-2 5c-1 3-4 4-7 3-3-1-4-4-3-7l4-10c2-6 8-10 14-10Z" fill="#167a3f"/></svg>`),
      breath: svgData(`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 96 96"><rect width="96" height="96" rx="18" fill="#eefcff"/><path d="M50 16c6 0 10 4 10 10s-4 10-10 10-10-4-10-10 4-10 10-10Zm-22 56c0-12 10-22 22-22s22 10 22 22v6c0 4-3 7-7 7H35c-4 0-7-3-7-7v-6Zm14 0h16c0-6-3-10-8-10s-8 4-8 10Z" fill="#0f6b78"/></svg>`)
    };

    function svgData(svg){ return "data:image/svg+xml;charset=UTF-8," + encodeURIComponent(svg); }

    const EXERCISES = [
      { id:"breath", nameKK:"–î–∏–∞—Ñ—Ä–∞–≥–º–∞–ª—ã“õ —Ç—ã–Ω—ã—Å", nameEN:"Diaphragmatic Breathing", icon:"breath",
        howto:["–ê—Ä“õ–∞“£—ã–∑–±–µ–Ω –∂–∞—Ç—ã“£—ã–∑, –±—ñ—Ä “õ–æ–ª –∫–µ—É–¥–µ–¥–µ, –±—ñ—Ä “õ–æ–ª —ñ—à—Ç–µ.","–ú“±—Ä–Ω—ã“£—ã–∑–±–µ–Ω —Ç—ã–Ω—ã—Å –∞–ª—ã–ø, —ñ—à—Ç—ñ“£ –∫”©—Ç–µ—Ä—ñ–ª–≥–µ–Ω—ñ–Ω —Å–µ–∑—ñ“£—ñ–∑.","–ê—É—ã–∑–±–µ–Ω –±–∞—è—É —à—ã“ì–∞—Ä—ã“£—ã–∑, –±–µ–ª–¥—ñ “õ—ã—Å–ø–∞–π –±–æ—Å–∞“£—Å—ã—Ç—ã“£—ã–∑.","–ò—ã“õ –∫”©—Ç–µ—Ä—ñ–ª–º–µ—Å—ñ–Ω, —Ç—ã–Ω—ã—Å –∂“±–º—Å–∞“õ –±–æ–ª—Å—ã–Ω."] },
      { id:"catcow", nameKK:"–ú—ã—Å—ã“õ‚Äì—Å–∏—ã—Ä", nameEN:"Cat‚ÄìCow", icon:"stretch",
        howto:["–¢”©—Ä—Ç—Ç–∞“ì–∞–Ω–¥–∞–ø —Ç“±—Ä—ã“£—ã–∑: –∞–ª–∞“õ–∞–Ω –∏—ã“õ –∞—Å—Ç—ã–Ω–¥–∞, —Ç—ñ–∑–µ –∂–∞–º–±–∞—Å –∞—Å—Ç—ã–Ω–¥–∞.","–¢—ã–Ω—ã—Å –∞–ª—ã–ø, –∫–µ—É–¥–µ–Ω—ñ –∞—à—ã–ø, –±–µ–ª–¥—ñ –∞–∑–¥–∞–ø –æ–π—ã“£—ã–∑.","–¢—ã–Ω—ã—Å —à—ã“ì–∞—Ä—ã–ø, –∞—Ä“õ–∞–Ω—ã –¥”©“£–≥–µ–ª–µ—Ç—ñ–ø, –∏–µ–∫—Ç—ñ —ñ—à–∫–µ –∞–ª—ã“£—ã–∑.","“ö–æ–∑“ì–∞–ª—ã—Å –±—ñ—Ä“õ–∞–ª—ã–ø—Ç—ã, –∞—É—ã—Ä—Å—ã–Ω—É—Å—ã–∑."] },
      { id:"pelvic", nameKK:"–ñ–∞–º–±–∞—Å—Ç—ã –µ“£–∫–µ–π—Ç—É", nameEN:"Pelvic Tilt", icon:"core",
        howto:["–ê—Ä“õ–∞“£—ã–∑–±–µ–Ω –∂–∞—Ç—ã“£—ã–∑, —Ç—ñ–∑–µ –±“Ø–≥—É–ª—ñ, —Ç–∞–±–∞–Ω –∂–µ—Ä–¥–µ.","–ë–µ–ª–¥—ñ –∂–µ—Ä–≥–µ –∂“±–º—Å–∞“õ –±–∞—Å—ã–ø, —ñ—à—Ç—ñ –∂–µ“£—ñ–ª —Ç–∞—Ä—Ç–∞—Å—ã–∑.","–°–æ—Å—ã–Ω –Ω–µ–π—Ç—Ä–∞–ª “õ–∞–ª—ã–ø“õ–∞ “õ–∞–π—Ç–∞ –∫–µ–ª—ñ“£—ñ–∑.","“ö–æ–∑“ì–∞–ª—ã—Å –∫—ñ—à—ñ –∞–º–ø–ª–∏—Ç—É–¥–∞–¥–∞, –±–∞“õ—ã–ª–∞—É–º–µ–Ω."] },
      { id:"deadbug", nameKK:"¬´”®–ª—ñ “õ–æ“£—ã–∑¬ª", nameEN:"Dead Bug", icon:"core",
        howto:["–ê—Ä“õ–∞“£—ã–∑–±–µ–Ω –∂–∞—Ç—ã“£—ã–∑, —Ç—ñ–∑–µ 90¬∞, “õ–æ–ª–¥–∞—Ä –∂–æ“ì–∞—Ä—ã.","–Ü—à—Ç—ñ —Ç–∞—Ä—Ç—ã–ø, –±–µ–ª–¥—ñ –Ω–µ–π—Ç—Ä–∞–ª–¥–∞ “±—Å—Ç–∞“£—ã–∑.","“ö–∞—Ä–∞–º–∞-“õ–∞—Ä—Å—ã “õ–æ–ª –º–µ–Ω –∞—è“õ—Ç—ã –±–∞—è—É —Å–æ–∑—ã“£—ã–∑.","–ë–µ–ª –∫”©—Ç–µ—Ä—ñ–ª—Å–µ, –∞–º–ø–ª–∏—Ç—É–¥–∞–Ω—ã –∞–∑–∞–π—Ç—ã“£—ã–∑."] },
      { id:"birddog", nameKK:"“ö“±—Å‚Äì–∏—Ç", nameEN:"Bird‚ÄìDog", icon:"core",
        howto:["–¢”©—Ä—Ç—Ç–∞“ì–∞–Ω–¥–∞–ø —Ç“±—Ä—ã“£—ã–∑, –∞—Ä“õ–∞ –Ω–µ–π—Ç—Ä–∞–ª.","“ö–∞—Ä–∞–º–∞-“õ–∞—Ä—Å—ã “õ–æ–ª –º–µ–Ω –∞—è“õ—Ç—ã —Ç“Ø–∑—É —Å–æ–∑—ã“£—ã–∑.","–ñ–∞–º–±–∞—Å “õ–∏—Å–∞–π–º–∞—Å—ã–Ω, –º–æ–π—ã–Ω “±–∑—ã–Ω.","–ë–∞—è—É “õ–∞–π—Ç—ã–ø, –∂–∞“õ—Ç–∞—Ä—ã–Ω –∞—É—ã—Å—Ç—ã—Ä—ã“£—ã–∑."] },
      { id:"bridge", nameKK:"–ñ–∞–º–±–∞—Å –∫”©–ø—ñ—Ä—ñ", nameEN:"Glute Bridge", icon:"back",
        howto:["–ê—Ä“õ–∞“£—ã–∑–±–µ–Ω –∂–∞—Ç—ã“£—ã–∑, —Ç—ñ–∑–µ –±“Ø–≥—É–ª—ñ, —Ç–∞–±–∞–Ω –∂–µ—Ä–¥–µ.","”®–∫—à–µ–º–µ–Ω —Ç—ñ—Ä–µ–Ω—ñ–ø, –∂–∞–º–±–∞—Å—Ç—ã –∂–æ“ì–∞—Ä—ã –∫”©—Ç–µ—Ä—ñ“£—ñ–∑.","“ö–∞–±—ã—Ä“ì–∞ —Å–∏—è“õ—Ç—ã —Ç“Ø–∑—É –±–æ–ª—Å—ã–Ω: –∏—ã“õ‚Äì–∂–∞–º–±–∞—Å‚Äì—Ç—ñ–∑–µ.","–ë–µ–ª–¥—ñ —à–∞–º–∞–¥–∞–Ω —Ç—ã—Å –º–∞–π—ã—Å—Ç—ã—Ä–º–∞“£—ã–∑."] },
      { id:"wallangels", nameKK:"“ö–∞–±—ã—Ä“ì–∞–¥–∞“ì—ã ¬´–ø–µ—Ä—ñ—à—Ç–µ–ª–µ—Ä¬ª", nameEN:"Wall Angels", icon:"posture",
        howto:["–ê—Ä“õ–∞“£—ã–∑–¥—ã “õ–∞–±—ã—Ä“ì–∞“ì–∞ —Ç—ñ—Ä–µ–ø —Ç“±—Ä—ã“£—ã–∑: –±–∞—Å, –∂–∞—É—ã—Ä—ã–Ω, –∂–∞–º–±–∞—Å –∂–∞“õ—ã–Ω.","–®—ã–Ω—Ç–∞“õ 90¬∞, “õ–æ–ª–¥—ã “õ–∞–±—ã—Ä“ì–∞ –±–æ–π—ã–º–µ–Ω –∂–æ“ì–∞—Ä—ã-—Ç”©–º–µ–Ω —Å—ã—Ä“ì—ã—Ç—ã“£—ã–∑.","–ë–µ–ª “õ–∞—Ç—Ç—ã –æ–π—ã–ª–º–∞—Å—ã–Ω, “õ–∞–±—ã—Ä“ì–∞“ì–∞ –∂–∞“õ—ã–Ω “±—Å—Ç–∞“£—ã–∑.","“ö–æ–∑“ì–∞–ª—ã—Å –±–∞—è—É, –∂–∞—É—ã—Ä—ã–Ω –±–∞“õ—ã–ª–∞—É–º–µ–Ω."] },
      { id:"scap", nameKK:"–ñ–∞—É—ã—Ä—ã–Ω–¥—ã “õ—ã—Å—ã–ø “±—Å—Ç–∞—É", nameEN:"Scapular Squeeze", icon:"posture",
        howto:["–¢—ñ–∫ –æ—Ç—ã—Ä—ã“£—ã–∑/—Ç“±—Ä—ã“£—ã–∑, –∏—ã“õ —Ç”©–º–µ–Ω.","–ñ–∞—É—ã—Ä—ã–Ω–¥—ã –∞—Ä—Ç“õ–∞ –∂”ô–Ω–µ —Ç”©–º–µ–Ω “õ–∞—Ä–∞–π “õ—ã—Å—ã“£—ã–∑.","–ú–æ–π—ã–Ω–¥—ã “õ—ã—Å—ã–º–∞–π, –∫–µ—É–¥–µ–Ω—ñ –∞—à—ã“£—ã–∑.","2‚Äì3 —Å–µ–∫—É–Ω–¥ “±—Å—Ç–∞–ø, –±–æ—Å–∞—Ç—ã“£—ã–∑."] },
      { id:"thorrot", nameKK:"–ö–µ—É–¥–µ –æ–º—ã—Ä—Ç“õ–∞—Å—ã–Ω –±“±—Ä–∞—É", nameEN:"Thoracic Rotation", icon:"stretch",
        howto:["–ñ–∞–Ω–º–µ–Ω –∂–∞—Ç—ã“£—ã–∑, —Ç—ñ–∑–µ–ª–µ—Ä –±“Ø–≥—É–ª—ñ (–µ–∫—ñ —Ç—ñ–∑–µ –±—ñ—Ä–≥–µ).","–ñ–æ“ì–∞—Ä“ì—ã “õ–æ–ª–¥—ã –∞–ª–¥—ã“ì–∞ —Å–æ–∑—ã–ø, —Å–æ—Å—ã–Ω –∞—Ä—Ç“õ–∞ –∞—à—ã“£—ã–∑.","–ñ–∞–º–±–∞—Å “õ–æ–∑“ì–∞–ª–º–∞—Å—ã–Ω, –±“±—Ä–∞–ª—É –∫–µ—É–¥–µ –∞–π–º–∞“ì—ã–Ω–¥–∞.","–¢—ã–Ω—ã—Å —à—ã“ì–∞—Ä—É–º–µ–Ω –∞—à—ã“£—ã–∑."] },
      { id:"child", nameKK:"–ë–∞–ª–∞–Ω—ã“£ “õ–∞–ª—ã–ø-–∫“Ø–π—ñ", nameEN:"Child‚Äôs Pose", icon:"stretch",
        howto:["–¢—ñ–∑–µ—Ä–ª–µ–ø –æ—Ç—ã—Ä—ã–ø, –∂–∞–º–±–∞—Å—Ç—ã ”©–∫—à–µ–≥–µ —Ç“Ø—Å—ñ—Ä—ñ“£—ñ–∑.","“ö–æ–ª–¥—ã –∞–ª“ì–∞ —Å–æ–∑—ã–ø, –º–∞“£–¥–∞–π–¥—ã –∂–µ—Ä–≥–µ –∂–∞“õ—ã–Ω–¥–∞—Ç—ã“£—ã–∑.","–ò—ã“õ—Ç—ã –±–æ—Å–∞“£—Å—ã—Ç—ã“£—ã–∑, —Ç—ã–Ω—ã—Å –±—ñ—Ä“õ–∞–ª—ã–ø—Ç—ã.","–ë–µ–ª–≥–µ –∂–∞–π–ª—ã –∞–º–ø–ª–∏—Ç—É–¥–∞ —Ç–∞“£–¥–∞“£—ã–∑."] },
      { id:"chin", nameKK:"–ò–µ–∫—Ç—ñ —ñ—à–∫–µ —Ç–∞—Ä—Ç—É", nameEN:"Chin Tuck", icon:"posture",
        howto:["“ö–∞–±—ã—Ä“ì–∞“ì–∞ –Ω–µ–º–µ—Å–µ –æ—Ä—ã–Ω–¥—ã“õ“õ–∞ —Å“Ø–π–µ–Ω—ñ–ø –æ—Ç—ã—Ä—ã“£—ã–∑.","–ò–µ–∫—Ç—ñ –∞–∑–¥–∞–ø –∞—Ä—Ç“õ–∞ —Ç–∞—Ä—Ç—ã–ø, –º–æ–π—ã–Ω–¥—ã “±–∑–∞—Ä—Ç–∞—Å—ã–∑.","–ë–∞—Å –∂–æ“ì–∞—Ä—ã“ì–∞ ¬´—Å–æ–∑—ã–ª“ì–∞–Ω–¥–∞–π¬ª —Å–µ–∑—ñ–ª—Å—ñ–Ω.","–ê—É—ã—Ä—Å—ã–Ω—É—Å—ã–∑, “õ—ã—Å—ã–º—Å—ã–∑ –æ—Ä—ã–Ω–¥–∞“£—ã–∑."] },
      { id:"balance1", nameKK:"–ë—ñ—Ä –∞—è“õ—Ç–∞ —Ç–µ–ø–µ-—Ç–µ“£–¥—ñ–∫", nameEN:"Single-Leg Balance", icon:"balance",
        howto:["–¢—ñ–∫ —Ç“±—Ä—ã“£—ã–∑, –∫”©–∑ –±—ñ—Ä –Ω“Ø–∫—Ç–µ–¥–µ.","–ë—ñ—Ä –∞—è“õ—Ç—ã –∞–∑–¥–∞–ø –∫”©—Ç–µ—Ä—ñ–ø, –∂–∞–º–±–∞—Å –¥–µ“£–≥–µ–π—ñ–Ω —Ç–µ“£ “±—Å—Ç–∞“£—ã–∑.","“ö–∞–∂–µ—Ç –±–æ–ª—Å–∞, “õ–∞–±—ã—Ä“ì–∞“ì–∞ –∂–µ“£—ñ–ª —Ç—ñ—Ä–µ–Ω—ñ“£—ñ–∑.","–¢—ã–Ω—ã—Å —Å–∞“õ—Ç–∞–ª—ã–ø —Ç“±—Ä—Å—ã–Ω."] },
      { id:"clamshell", nameKK:"¬´“ö–∞–±—ã“õ—à–∞¬ª", nameEN:"Clamshell", icon:"balance",
        howto:["–ñ–∞–Ω–º–µ–Ω –∂–∞—Ç—ã“£—ã–∑, —Ç—ñ–∑–µ–ª–µ—Ä –±“Ø–≥—É–ª—ñ, —Ç–∞–±–∞–Ω–¥–∞—Ä –±—ñ—Ä–≥–µ.","–ñ–∞–º–±–∞—Å—Ç—ã “õ–æ–∑“ì–∞—É—Å—ã–∑, “Ø—Å—Ç—ñ“£–≥—ñ —Ç—ñ–∑–µ–Ω—ñ –∞—à—ã“£—ã–∑.","–ë–µ–ª –±“±—Ä—ã–ª–º–∞—Å—ã–Ω, “õ–æ–∑“ì–∞–ª—ã—Å –∂–∞–º–±–∞—Å –±—É—ã–Ω—ã–Ω–¥–∞.","–ë–∞—è—É –∂–∞—É—ã–ø, “õ–∞–π—Ç–∞–ª–∞“£—ã–∑."] },
      { id:"door", nameKK:"–ï—Å—ñ–∫ –∂–∞“õ—Ç–∞—É—ã–Ω–¥–∞ –∫–µ—É–¥–µ —Å–æ–∑—É", nameEN:"Doorway Chest Stretch", icon:"stretch",
        howto:["–ï—Å—ñ–∫ –∂–∞“õ—Ç–∞—É—ã–Ω–∞ “õ–æ–ª–¥—ã 90¬∞ “õ–æ–π—ã“£—ã–∑.","–ë—ñ—Ä “õ–∞–¥–∞–º –∞–ª“ì–∞ —à—ã“ì—ã–ø, –∫–µ—É–¥–µ–Ω—ñ –∂“±–º—Å–∞“õ –∞—à—ã“£—ã–∑.","–ò—ã“õ—Ç—ã “õ“±–ª–∞“õ“õ–∞ –∫”©—Ç–µ—Ä–º–µ“£—ñ–∑.","–ê—É—ã—Ä—Å—ã–Ω—É—Å—ã–∑, —Ç–µ–∫ —Å–æ–∑—ã–ª—É —Å–µ–∑—ñ–º—ñ."] }
    ];

    const BADGES = [
      { key:"first", title:"–ê–ª“ì–∞—à“õ—ã “õ–∞–¥–∞–º", desc:"1 –∫“Ø–Ω –∞—è“õ—Ç–∞–¥—ã“£—ã–∑", icon:"fa-shoe-prints", rule:(p)=>p.completedCount>=1 },
      { key:"seven", title:"7 –∫“Ø–Ω “õ–∞—Ç–∞—Ä", desc:"7 –∫“Ø–Ω “Ø–∑—ñ–ª—ñ—Å—Å—ñ–∑ –æ—Ä—ã–Ω–¥–∞–¥—ã“£—ã–∑", icon:"fa-fire", rule:(p)=>p.streak>=7 },
      { key:"fifteen", title:"–ñ–∞—Ä—Ç—ã –∂–æ–ª", desc:"15 –∫“Ø–Ω –∞—è“õ—Ç–∞–ª–¥—ã", icon:"fa-flag-checkered", rule:(p)=>p.completedCount>=15 },
      { key:"thirty", title:"30 –∫“Ø–Ω —á–µ–º–ø–∏–æ–Ω", desc:"30 –∫“Ø–Ω —Ç–æ–ª—ã“õ –∞—è“õ—Ç–∞–ª–¥—ã", icon:"fa-crown", rule:(p)=>p.completedCount>=30 },
      { key:"nopause", title:"–¢–∞–∑–∞ –æ—Ä—ã–Ω–¥–∞—É", desc:"–ñ–∞—Ç—Ç—ã“ì—É–¥—ã –ø–∞—É–∑–∞—Å—ã–∑ –∞—è“õ—Ç–∞–¥—ã“£—ã–∑", icon:"fa-bolt", rule:(p)=>p.noPauseWins>=1 },
      { key:"hard", title:"–ö“Ø—Ä–¥–µ–ª—ñ–≥–µ –¥–∞–π—ã–Ω", desc:"–ö“Ø—Ä–¥–µ–ª—ñ –¥–µ“£–≥–µ–π–¥–µ 5 –∫“Ø–Ω –∞—è“õ—Ç–∞–¥—ã“£—ã–∑", icon:"fa-dumbbell", rule:(p)=>p.advancedDays>=5 }
    ];

    let state = {
      level: "beginner",
      day: 1,
      dayData: null,
      sequence: [],
      idx: 0,
      timer: null,
      timeLeft: 0,
      paused: false,
      pausedUsed: false,
      totalSeconds: 0,
      mood: null
    };

    function phaseByDay(day){
      if(day<=10) return 1;
      if(day<=20) return 2;
      return 3;
    }

    function levelLabel(level){
      if(level==="beginner") return "–ë–∞—Å—Ç–∞—É—à—ã";
      if(level==="intermediate") return "–û—Ä—Ç–∞—à–∞";
      return "–ö“Ø—Ä–¥–µ–ª—ñ";
    }

    function paramsFor(level, day){
      const ph = phaseByDay(day);
      const base = {
        1:{ exSec:30, restSec:10, rule:"30 —Å–µ–∫—É–Ω–¥ + 10 —Å–µ–∫—É–Ω–¥ –¥–µ–º–∞–ª—ã—Å" },
        2:{ exSec:35, restSec:10, rule:"35 —Å–µ–∫—É–Ω–¥ + 10 —Å–µ–∫—É–Ω–¥ –¥–µ–º–∞–ª—ã—Å" },
        3:{ exSec:40, restSec:10, rule:"40 —Å–µ–∫—É–Ω–¥ + 10 —Å–µ–∫—É–Ω–¥ –¥–µ–º–∞–ª—ã—Å" }
      }[ph];

      const counts = {
        beginner:   {1:8, 2:9, 3:10},
        intermediate:{1:9, 2:10, 3:11},
        advanced:   {1:10,2:11,3:12}
      }[level];

      const exCount = counts[ph];
      let restSec = base.restSec;
      let exSec = base.exSec;

      if(level==="advanced"){
        restSec = ph===1 ? 12 : 15;
        exSec = ph===1 ? 35 : (ph===2 ? 40 : 45);
      }
      if(level==="intermediate"){
        if(ph===3) exSec = 40;
      }

      const label = `${exSec} —Å–µ–∫—É–Ω–¥ + ${restSec} —Å–µ–∫—É–Ω–¥ –¥–µ–º–∞–ª—ã—Å`;
      return { exSec, restSec, exCount, rule: label };
    }

    function pickExercises(level, day, count){
      const seed = (day*97 + (level==="beginner"?1:level==="intermediate"?2:3)*131) % 100000;
      const arr = [...EXERCISES];
      for(let i=arr.length-1;i>0;i--){
        const j = (seed + i*37) % (i+1);
        const t = arr[i]; arr[i]=arr[j]; arr[j]=t;
      }
      const coreFirst = ["breath","catcow","pelvic"];
      const picked = [];
      coreFirst.forEach(id=>{
        const ex = EXERCISES.find(x=>x.id===id);
        if(ex) picked.push(ex);
      });
      for(const ex of arr){
        if(picked.length>=count) break;
        if(!picked.find(x=>x.id===ex.id)) picked.push(ex);
      }
      return picked.slice(0,count);
    }

    function buildDay(level, day){
      const p = paramsFor(level, day);
      const exercises = pickExercises(level, day, p.exCount).map(x=>({ ...x, duration:p.exSec }));
      const sequence = [];
      exercises.forEach((ex, i)=>{
        sequence.push({ type:"ex", ...ex });
        if(i !== exercises.length-1){
          sequence.push({ type:"rest", id:"rest", nameKK:"–î–µ–º–∞–ª—ã—Å", nameEN:"Rest", duration:p.restSec, icon:"breath",
            howto:["–ú“±—Ä—ã–Ω–º–µ–Ω —Ç—ã–Ω—ã—Å –∞–ª—ã“£—ã–∑.","–ò—ã“õ—Ç—ã –±–æ—Å–∞“£—Å—ã—Ç—ã“£—ã–∑.","–ö–µ–ª–µ—Å—ñ –∂–∞—Ç—Ç—ã“ì—É“ì–∞ –¥–∞–π—ã–Ω–¥–∞–ª—ã“£—ã–∑."] });
        }
      });

      const totalSeconds = sequence.reduce((s,a)=>s+a.duration,0);
      return {
        day,
        level,
        rule: p.rule,
        exCount: exercises.length,
        restSec: p.restSec,
        exSec: p.exSec,
        exercises,
        sequence,
        totalSeconds
      };
    }

    function fmtTime(sec){
      const m = Math.floor(sec/60);
      const s = sec%60;
      return `${m<10?"0":""}${m}:${s<10?"0":""}${s}`;
    }

    function showView(id){
      document.querySelectorAll(".view-section").forEach(el=>el.classList.remove("active"));
      document.getElementById(id).classList.add("active");
      window.scrollTo(0,0);
    }

    function selectLevel(level){
      state.level = level;
      document.getElementById("plan-title").innerText = `${levelLabel(level)} –¥–µ“£–≥–µ–π`;
      const grid = document.getElementById("days-grid");
      grid.innerHTML = "";
      for(let d=1; d<=30; d++){
        const dd = buildDay(level, d);
        const done = isDayCompleted(level, d);
        const btn = document.createElement("button");
        btn.className = `p-4 rounded-xl shadow-sm border transition transform hover:scale-[1.03] flex justify-between items-center ${done ? "bg-green-600 text-white border-green-600" : "bg-white text-gray-900 border-gray-100 hover:bg-gray-50"}`;
        btn.onclick = ()=>openDayOverview(d);
        btn.innerHTML = `
          <div class="flex flex-col items-start">
            <span class="font-extrabold text-lg">${d} –∫“Ø–Ω</span>
            <span class="text-xs font-semibold ${done ? "text-white/90" : "text-gray-500"}">${dd.exCount} –∂–∞—Ç—Ç—ã“ì—É</span>
          </div>
          <div class="text-right">
            <span class="text-sm font-extrabold ${done ? "bg-white/20" : "bg-gray-100"} px-2 py-1 rounded">${fmtTime(dd.totalSeconds)}</span>
            <div class="mt-2">
              ${done ? `<span class="text-xs font-extrabold"><i class="fa-solid fa-check"></i> –ê—è“õ—Ç–∞–ª–¥—ã</span>` : `<span class="text-xs text-gray-400 font-extrabold">–ö–µ–∑–µ“£ ${phaseByDay(d)}/3</span>`}
            </div>
          </div>
        `;
        grid.appendChild(btn);
      }
      showView("view-plan");
    }

    function openDayOverview(day){
      state.day = day;
      const dd = buildDay(state.level, day);
      state.dayData = dd;
      state.sequence = dd.sequence;
      state.idx = 0;
      state.paused = false;
      state.pausedUsed = false;
      state.totalSeconds = dd.totalSeconds;

      document.getElementById("overview-day-title").innerText = `${day}-–∫“Ø–Ω`;
      document.getElementById("overview-time").innerText = fmtTime(dd.totalSeconds);
      document.getElementById("overview-count").innerText = `${dd.exCount} –∂–∞—Ç—Ç—ã“ì—É`;
      document.getElementById("overview-rest").innerText = `–î–µ–º–∞–ª—ã—Å: ${dd.restSec} —Å`;
      document.getElementById("overview-rule").innerText = dd.rule;

      const list = document.getElementById("exercise-list");
      list.innerHTML = "";
      dd.exercises.forEach(ex=>{
        const item = document.createElement("div");
        item.className = "flex gap-4 bg-white p-4 rounded-2xl shadow-sm border border-gray-100";
        item.innerHTML = `
          <div class="w-14 h-14 rounded-xl bg-gray-50 flex items-center justify-center overflow-hidden">
            <img src="${ICONS[ex.icon]}" alt="${ex.nameKK}" class="w-full h-full object-cover"/>
          </div>
          <div class="flex-1">
            <div class="flex items-start justify-between gap-3">
              <div>
                <h4 class="font-extrabold text-gray-900">${ex.nameKK} <span class="text-gray-400 font-semibold">(${ex.nameEN})</span></h4>
                <p class="text-sm text-gray-600 mt-1">${ex.howto[0]}</p>
              </div>
              <span class="text-xs font-extrabold text-gray-700 bg-gray-100 px-2 py-1 rounded-full">${fmtTime(ex.duration)}</span>
            </div>
          </div>
        `;
        list.appendChild(item);
      });

      showView("view-overview");
    }

    function startWorkout(){
      state.idx = 0;
      loadItem(0);
      showView("view-workout");
    }

    function loadItem(i){
      if(i >= state.sequence.length){
        showResult();
        return;
      }
      state.idx = i;
      state.timeLeft = state.sequence[i].duration;
      state.paused = false;

      const it = state.sequence[i];
      document.getElementById("workout-step").innerText = `${i+1} / ${state.sequence.length}`;
      document.getElementById("btn-play-pause").innerHTML = `<i class="fa-solid fa-pause fa-2x"></i>`;
      document.getElementById("tips-overlay").classList.add("hidden");

      const title = it.type==="rest" ? "–î–µ–º–∞–ª—ã—Å" : `${it.nameKK} (${it.nameEN})`;
      const sub = it.type==="rest" ? "“ö–∞–ª–ø—ã“£—ã–∑–¥—ã —Ç“Ø–∑–µ“£—ñ–∑, —Ç—ã–Ω—ã—Å –∞–ª—ã“£—ã–∑" : "–¢–µ—Ö–Ω–∏–∫–∞ + –±–∞“õ—ã–ª–∞—É";
      document.getElementById("workout-name").innerText = title;
      document.getElementById("workout-sub").innerText = sub;
      document.getElementById("timer-label").innerText = it.type==="rest" ? "–î–ï–ú–ê–õ–´–°" : "–ñ–ê–¢–¢–´“í–£";

      const imgBox = document.getElementById("workout-image");
      imgBox.innerHTML = `<img src="${ICONS[it.icon]}" alt="${it.nameKK}" class="w-full h-full object-cover"/>`;

      const how = document.getElementById("howto");
      how.innerHTML = "";
      it.howto.forEach(step=>{
        const li = document.createElement("li");
        li.innerText = step;
        how.appendChild(li);
      });

      const yt = document.getElementById("youtube-link");
      const q = it.type==="rest" ? "breathing exercise" : it.nameEN;
      yt.href = `https://www.youtube.com/results?search_query=${encodeURIComponent(q)}`;

      document.getElementById("tip-text").innerText = it.type==="rest"
        ? "–ê—Ä“õ–∞“£—ã–∑–¥—ã —Ç—ñ–∫ “±—Å—Ç–∞“£—ã–∑. –ö–µ–ª–µ—Å—ñ “õ–∏–º—ã–ª–¥—ã –∞–ª–¥—ã–Ω –∞–ª–∞ –¥–∞–π—ã–Ω–¥–∞–ø “õ–æ–π—ã“£—ã–∑."
        : "–ê—Å—ã“õ–ø–∞“£—ã–∑: —Å–∞–ø–∞ ”ô—Ä“õ–∞—à–∞–Ω —Å–∞–Ω–Ω–∞–Ω –º–∞“£—ã–∑–¥—ã.";

      clearInterval(state.timer);
      updateTimerUI();
      state.timer = setInterval(tick, 1000);
    }

    function tick(){
      if(state.paused) return;
      if(state.timeLeft > 0){
        state.timeLeft--;
        updateTimerUI();
      }else{
        nextExercise();
      }
    }

    function updateTimerUI(){
      const it = state.sequence[state.idx];
      document.getElementById("timer-display").innerText = fmtTime(state.timeLeft);
      const circle = document.getElementById("timer-circle");
      const circumference = 753.98;
      const percent = it.duration ? (state.timeLeft / it.duration) : 0;
      circle.style.strokeDashoffset = circumference - (percent * circumference);
    }

    function toggleTimer(){
      state.paused = !state.paused;
      if(state.paused) state.pausedUsed = true;
      document.getElementById("btn-play-pause").innerHTML = state.paused
        ? `<i class="fa-solid fa-play fa-2x"></i>`
        : `<i class="fa-solid fa-pause fa-2x"></i>`;
    }

    function nextExercise(){ loadItem(state.idx + 1); }
    function prevExercise(){ if(state.idx>0) loadItem(state.idx - 1); }

    function quitWorkout(){
      if(confirm("–ñ–∞—Ç—Ç—ã“ì—É–¥—ã —Ç–æ“õ—Ç–∞—Ç“õ—ã“£—ã–∑ –∫–µ–ª–µ –º–µ?")){
        clearInterval(state.timer);
        showView("view-overview");
      }
    }

    function toggleTips(){
      document.getElementById("tips-overlay").classList.toggle("hidden");
    }

    function showResult(){
      clearInterval(state.timer);
      const dd = state.dayData;
      document.getElementById("result-time").innerText = fmtTime(dd.totalSeconds);
      document.getElementById("result-count").innerText = dd.exCount;
      showView("view-result");
    }

    function saveMood(m){ state.mood = m; }

    function finishWorkout(){
      const userStr = localStorage.getItem("arqa_current_user");
      if(userStr){
        saveWorkoutProgress(state.level, state.day, state.dayData, !state.pausedUsed, state.mood);
      }
      state.mood = null;
      showView("view-levels");
    }

    function toggleAuth(){
      const modal = document.getElementById("auth-modal");
      modal.classList.toggle("hidden");
      if(!modal.classList.contains("hidden")) showAuthTab("signup");
    }

    function toggleAuthTab(){
      const s = document.getElementById("auth-signup");
      const l = document.getElementById("auth-login");
      if(s.classList.contains("hidden")){ s.classList.remove("hidden"); l.classList.add("hidden"); }
      else{ s.classList.add("hidden"); l.classList.remove("hidden"); }
    }

    function showAuthTab(tab){
      const s = document.getElementById("auth-signup");
      const l = document.getElementById("auth-login");
      if(tab==="signup"){ s.classList.remove("hidden"); l.classList.add("hidden"); }
      else{ s.classList.add("hidden"); l.classList.remove("hidden"); }
    }

    function signupUser(){
      const fullname = document.getElementById("signup-fullname").value.trim();
      const email = document.getElementById("signup-email").value.trim();
      const password = document.getElementById("signup-password").value;
      const confirm = document.getElementById("signup-confirm").value;

      if(!fullname || !email || !password || !confirm){ alert("–ë–∞—Ä–ª—ã“õ ”©—Ä—ñ—Å—Ç—ñ —Ç–æ–ª—Ç—ã—Ä—ã“£—ã–∑"); return; }
      if(!email.includes("@")){ alert("–î“±—Ä—ã—Å email –µ–Ω–≥—ñ–∑—ñ“£—ñ–∑"); return; }
      if(password.length < 6){ alert("–ü–∞—Ä–æ–ª—å –∫–µ–º—ñ–Ω–¥–µ 6 —Ç–∞“£–±–∞ –±–æ–ª—É—ã –∫–µ—Ä–µ–∫"); return; }
      if(password !== confirm){ alert("–ü–∞—Ä–æ–ª—å–¥–µ—Ä —Å”ô–π–∫–µ—Å –µ–º–µ—Å"); return; }

      let users = JSON.parse(localStorage.getItem("arqa_users")) || [];
      if(users.find(u=>u.email===email)){ alert("–ë“±–ª email –±“±—Ä—ã–Ω–Ω–∞–Ω –±–∞—Ä"); return; }

      const newUser = {
        id: Date.now(),
        fullname,
        email,
        password: btoa(password),
        createdAt: new Date().toISOString(),
        workoutProgress: { beginner:{}, intermediate:{}, advanced:{} },
        xp: 0,
        badges: [],
        activity: []
      };

      users.push(newUser);
      localStorage.setItem("arqa_users", JSON.stringify(users));
      localStorage.setItem("arqa_current_user", JSON.stringify(newUser));
      document.getElementById("user-display").innerText = fullname;
      document.getElementById("profile-btn").classList.remove("hidden");

      document.getElementById("signup-fullname").value = "";
      document.getElementById("signup-email").value = "";
      document.getElementById("signup-password").value = "";
      document.getElementById("signup-confirm").value = "";

      toggleAuth();
      alert("–°”ô—Ç—Ç—ñ —Ç—ñ—Ä–∫–µ–ª–¥—ñ“£—ñ–∑!");
    }

    function loginUser(){
      const email = document.getElementById("login-email").value.trim();
      const password = document.getElementById("login-password").value;
      if(!email || !password){ alert("Email –∂”ô–Ω–µ –ø–∞—Ä–æ–ª—å –µ–Ω–≥—ñ–∑—ñ“£—ñ–∑"); return; }

      let users = JSON.parse(localStorage.getItem("arqa_users")) || [];
      const user = users.find(u=>u.email===email && u.password===btoa(password));
      if(!user){ alert("Email –Ω–µ–º–µ—Å–µ –ø–∞—Ä–æ–ª—å “õ–∞—Ç–µ"); return; }

      localStorage.setItem("arqa_current_user", JSON.stringify(user));
      document.getElementById("user-display").innerText = user.fullname;
      document.getElementById("profile-btn").classList.remove("hidden");
      document.getElementById("login-email").value = "";
      document.getElementById("login-password").value = "";
      toggleAuth();
      alert("“ö–æ—à –∫–µ–ª–¥—ñ“£—ñ–∑!");
    }

    function logoutUser(){
      localStorage.removeItem("arqa_current_user");
      document.getElementById("user-display").innerText = "–ö—ñ—Ä—É –∫–µ—Ä–µ–∫";
      document.getElementById("profile-btn").classList.add("hidden");
      document.getElementById("profile-modal").classList.add("hidden");
      alert("–®—ã“õ—Ç—ã“£—ã–∑");
    }

    function toggleProfile(){
      const modal = document.getElementById("profile-modal");
      modal.classList.toggle("hidden");
      if(!modal.classList.contains("hidden")) loadUserProfile();
    }

    function isDayCompleted(level, day){
      const userStr = localStorage.getItem("arqa_current_user");
      if(!userStr) return false;
      const u = JSON.parse(userStr);
      const p = (u.workoutProgress && u.workoutProgress[level]) ? u.workoutProgress[level] : {};
      return Boolean(p && p[String(day)] && p[String(day)].completed);
    }

    function getUserLevelName(xp){
      if(xp>=700) return "–ì—Ä–∞–Ω–¥-–º–∞—Å—Ç–µ—Ä";
      if(xp>=400) return "–ü—Ä–æ";
      if(xp>=200) return "–¢”ô–∂—ñ—Ä–∏–±–µ–ª—ñ";
      if(xp>=80) return "”®—Å—ñ–ø –∫–µ–ª–µ–¥—ñ";
      return "–ë–∞—Å—Ç–∞—É—à—ã";
    }

    function computeStreak(progressByDay){
      let streak = 0;
      for(let d=1; d<=30; d++){
        if(progressByDay[String(d)] && progressByDay[String(d)].completed) streak++;
        else break;
      }
      return streak;
    }

    function saveWorkoutProgress(level, day, dayData, noPause, mood){
      const userStr = localStorage.getItem("arqa_current_user");
      if(!userStr) return;
      const u = JSON.parse(userStr);

      if(!u.workoutProgress) u.workoutProgress = { beginner:{}, intermediate:{}, advanced:{} };
      if(!u.workoutProgress[level]) u.workoutProgress[level] = {};

      u.workoutProgress[level][String(day)] = {
        completed: true,
        level,
        day,
        completedAt: new Date().toISOString(),
        totalSeconds: dayData.totalSeconds,
        exCount: dayData.exCount,
        phase: phaseByDay(day),
        noPause: Boolean(noPause),
        mood: mood || null
      };

      const xpAdd = (level==="beginner"?10:level==="intermediate"?14:18) + (phaseByDay(day)-1)*2 + (noPause?3:0);
      u.xp = (u.xp || 0) + xpAdd;

      u.activity = u.activity || [];
      u.activity.push({
        at: new Date().toISOString(),
        text: `${day}-–∫“Ø–Ω (${levelLabel(level)}): ${dayData.exCount} –∂–∞—Ç—Ç—ã“ì—É, ${fmtTime(dayData.totalSeconds)} (+${xpAdd} “±–ø–∞–π)`
      });

      const all = collectProgressStats(u);
      const newly = unlockBadges(u, all);

      localStorage.setItem("arqa_current_user", JSON.stringify(u));

      let users = JSON.parse(localStorage.getItem("arqa_users")) || [];
      const idx = users.findIndex(x=>x.email===u.email);
      if(idx !== -1){ users[idx] = u; localStorage.setItem("arqa_users", JSON.stringify(users)); }

      if(newly.length){
        openBadgeModal(newly[0].title + " ‚Äî " + newly[0].desc);
      }
    }

    function collectProgressStats(u){
      const levels = ["beginner","intermediate","advanced"];
      let completedCount = 0;
      let totalMinutes = 0;
      let noPauseWins = 0;
      let advancedDays = 0;

      levels.forEach(l=>{
        const p = (u.workoutProgress && u.workoutProgress[l]) ? u.workoutProgress[l] : {};
        Object.keys(p).forEach(k=>{
          if(p[k] && p[k].completed){
            completedCount++;
            totalMinutes += Math.round((p[k].totalSeconds||0)/60);
            if(p[k].noPause) noPauseWins++;
            if(l==="advanced") advancedDays++;
          }
        });
      });

      const baseStreak = computeStreak((u.workoutProgress && u.workoutProgress[u.lastLevelForStreak || "beginner"]) ? u.workoutProgress[u.lastLevelForStreak || "beginner"] : {});
      const bestStreak = Math.max(
        computeStreak(u.workoutProgress?.beginner || {}),
        computeStreak(u.workoutProgress?.intermediate || {}),
        computeStreak(u.workoutProgress?.advanced || {})
      );

      return { completedCount, totalMinutes, streak: bestStreak, noPauseWins, advancedDays };
    }

    function unlockBadges(u, stats){
      u.badges = u.badges || [];
      const newly = [];
      BADGES.forEach(b=>{
        if(!u.badges.includes(b.key) && b.rule(stats)){
          u.badges.push(b.key);
          newly.push(b);
        }
      });
      return newly;
    }

    function openBadgeModal(text){
      document.getElementById("badge-text").innerText = text;
      document.getElementById("badge-modal").classList.remove("hidden");
    }

    function closeBadgeModal(){
      document.getElementById("badge-modal").classList.add("hidden");
    }

    function loadUserProfile(){
      const userStr = localStorage.getItem("arqa_current_user");
      if(!userStr) return;
      const u = JSON.parse(userStr);

      document.getElementById("profile-fullname").innerText = u.fullname || "‚Äî";
      document.getElementById("profile-email").innerText = u.email || "‚Äî";
      document.getElementById("profile-created").innerText = u.createdAt ? new Date(u.createdAt).toLocaleDateString("kk-KZ") : "‚Äî";
      document.getElementById("profile-level").innerText = getUserLevelName(u.xp || 0);

      const stats = collectProgressStats(u);

      document.getElementById("progress-days").innerText = `${Math.min(stats.completedCount,30)}/30`;
      document.getElementById("progress-bar").style.width = `${Math.min((stats.completedCount/30)*100,100)}%`;

      document.getElementById("stat-workouts").innerText = stats.completedCount;
      document.getElementById("stat-minutes").innerText = stats.totalMinutes;
      document.getElementById("stat-streak").innerText = stats.streak;
      document.getElementById("stat-xp").innerText = u.xp || 0;

      const badgesBox = document.getElementById("badges");
      badgesBox.innerHTML = "";
      const owned = new Set(u.badges || []);
      BADGES.forEach(b=>{
        const on = owned.has(b.key);
        const div = document.createElement("div");
        div.className = `p-3 rounded-xl border flex gap-3 items-center ${on ? "bg-yellow-50 border-yellow-200" : "bg-gray-50 border-gray-100"}`;
        div.innerHTML = `
          <div class="w-10 h-10 rounded-xl flex items-center justify-center ${on ? "bg-yellow-100 text-yellow-700" : "bg-white text-gray-400"}">
            <i class="fa-solid ${b.icon}"></i>
          </div>
          <div class="min-w-0">
            <p class="font-extrabold text-sm ${on ? "text-gray-900" : "text-gray-400"} truncate">${b.title}</p>
            <p class="text-xs ${on ? "text-gray-600" : "text-gray-400"} truncate">${b.desc}</p>
          </div>
        `;
        badgesBox.appendChild(div);
      });

      const act = document.getElementById("activity-list");
      const a = (u.activity || []).slice(-6).reverse();
      if(!a.length){
        act.innerHTML = `<p class="text-gray-400">–ë–µ–ª—Å–µ–Ω–¥—ñ–ª—ñ–∫ –∂–æ“õ</p>`;
      }else{
        act.innerHTML = a.map(x=>`<p class="text-gray-700 flex items-start gap-2"><i class="fa-solid fa-check text-green-600 mt-1"></i><span>${x.text}</span></p>`).join("");
      }
    }

    window.addEventListener("load", ()=>{
      const cur = localStorage.getItem("arqa_current_user");
      if(cur){
        const u = JSON.parse(cur);
        document.getElementById("user-display").innerText = u.fullname || "“ö–æ–ª–¥–∞–Ω—É—à—ã";
        document.getElementById("profile-btn").classList.remove("hidden");
      }
    });
  </script>
</body>
</html>
